(()=>{var t={};t.d=function(e,r){for(var o in r)t.o(r,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:r[o]})},t.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var e={};(()=>{"use strict";t.r(e),t.d(e,{Sector:()=>L,StraightArrow:()=>A,DiagonalArrow:()=>O,DoveTailDiagonalArrow:()=>j,GatheringPlace:()=>F,ClosedCurve:()=>I,DoubleArrow:()=>D});let r=maptalks;function o(t,e){this.x=t,this.y=e}o.prototype={clone(){return new o(this.x,this.y)},add(t){return this.clone()._add(t)},sub(t){return this.clone()._sub(t)},multByPoint(t){return this.clone()._multByPoint(t)},divByPoint(t){return this.clone()._divByPoint(t)},mult(t){return this.clone()._mult(t)},div(t){return this.clone()._div(t)},rotate(t){return this.clone()._rotate(t)},rotateAround(t,e){return this.clone()._rotateAround(t,e)},matMult(t){return this.clone()._matMult(t)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(t){return this.x===t.x&&this.y===t.y},dist(t){return Math.sqrt(this.distSqr(t))},distSqr(t){let e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle(){return Math.atan2(this.y,this.x)},angleTo(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith(t){return this.angleWithSep(t.x,t.y)},angleWithSep(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult(t){let e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add(t){return this.x+=t.x,this.y+=t.y,this},_sub(t){return this.x-=t.x,this.y-=t.y,this},_mult(t){return this.x*=t,this.y*=t,this},_div(t){return this.x/=t,this.y/=t,this},_multByPoint(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint(t){return this.x/=t.x,this.y/=t.y,this},_unit(){return this._div(this.mag()),this},_perp(){let t=this.y;return this.y=this.x,this.x=-t,this},_rotate(t){let e=Math.cos(t),r=Math.sin(t),o=e*this.x-r*this.y,n=r*this.x+e*this.y;return this.x=o,this.y=n,this},_rotateAround(t,e){let r=Math.cos(t),o=Math.sin(t),n=e.x+r*(this.x-e.x)-o*(this.y-e.y),i=e.y+o*(this.x-e.x)+r*(this.y-e.y);return this.x=n,this.y=i,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:o},o.convert=function(t){if(t instanceof o)return t;if(Array.isArray(t))return new o(+t[0],+t[1]);if(void 0!==t.x&&void 0!==t.y)return new o(+t.x,+t.y);throw Error("Expected [x, y] or {x, y} point format")};let n=Math.PI/2,i=r.Coordinate,s=r.Canvas;function a(t,e,r){let o=e.x*r,n=e.y*r,i=t.add(o,n);return[i,t.add(-o,-n)]}let l=(t,e,r,n,i)=>{let s,l,h,u,c,d,y;e/=2;let p=0,g=[],m=[];for(let P=1,_=t.length;P<_;P++){if(h=new o(t[P].x,t[P].y),u=new o(t[P-1].x,t[P-1].y),n&&i?(p+=h.dist(u),s=(1-(1-n)*p/i)*e):s=e,c=P<_-1?new o(t[P+1].x,t[P+1].y):null,d=h.sub(u)._unit()._perp(),1===P&&(l=a(t[P-1],d,e,r),g.push(l[0]),m.push(l[1])),!(isNaN((y=c?function(t,e){let r=t.add(e)._unit(),o=r.x*e.x+r.y*e.y;return r._mult(1/o)}(d,c.sub(h)._unit()._perp()):d).x)||isNaN(y.y)))l=a(t[P],y,s,r),g.push(l[0]),m.push(l[1])}return[g,m]},h=(t,e)=>Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)),u=(t,e,r)=>t.measureLength(i.toCoordinates(e),i.toCoordinates(r)),c=function(t,e,r,o,n){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100,[s,a,l]=[null,null,n-o],h=[];l=l<0?l+2*Math.PI:l;for(let n=0;n<i;n++){let u=l*n/i+o;s=r*Math.cos(u),a=r*Math.sin(u);let c=t.locate({x:e[0],y:e[1]},s,a);h.push([c.x,c.y])}return h},d=t=>{let e=0;return t&&Array.isArray(t)&&t.length>0&&t.forEach((r,o)=>{o<t.length-1&&(e+=h(r,t[o+1]))}),e},y=t=>Math.pow(d(t),.99),p=(t,e)=>[(t[0]+e[0])/2,(t[1]+e[1])/2],g=(t,e)=>{let r;let o=Math.asin(Math.abs(e[1]-t[1])/h(t,e));return e[1]>=t[1]&&e[0]>=t[0]?r=o+Math.PI:e[1]>=t[1]&&e[0]<t[0]?r=2*Math.PI-o:e[1]<t[1]&&e[0]<t[0]?r=o:e[1]<t[1]&&e[0]>=t[0]&&(r=Math.PI-o),r},m=(t,e,r)=>{let o=g(e,t)-g(e,r);return o<0?o+2*Math.PI:o},P=(t,e,r)=>(r[1]-t[1])*(e[0]-t[0])>(e[1]-t[1])*(r[0]-t[0]),_=(t,e,r,o,n)=>{let[i,s]=[1-(t=Math.max(Math.min(t,1),0)),t*t],a=s*t,l=i*i,h=l*i,u=h*e[0]+3*l*t*r[0]+3*i*s*o[0]+a*n[0];return[u,h*e[1]+3*l*t*r[1]+3*i*s*o[1]+a*n[1]]},f=(t,e,r,o,n)=>{let i=g(t,e),s=n?i+r:i-r,a=o*Math.cos(s),l=o*Math.sin(s);return[e[0]+a,e[1]+l]},w=(t,e,r)=>{let o=t[0]-e[0],n=t[1]-e[1],i=Math.sqrt(o*o+n*n);o/=i,n/=i;let s=r[0]-e[0],a=r[1]-e[1],l=Math.sqrt(s*s+a*a),h=o+(s/=l);return[h,n+(a/=l)]},x=(t,e,r,o)=>{let n=w(e,r,o),[i,s,a,l,u]=[null,null,null,null,null],c=Math.sqrt(n[0]*n[0]+n[1]*n[1]),d=n[0]/c,y=n[1]/c,p=h(e,r),g=h(r,o);return c>1e-4?P(e,r,o)?(a=t*p,l=r[0]-a*y,i=[l,u=r[1]+a*d],a=t*g,l=r[0]+a*y,s=[l,u=r[1]-a*d]):(a=t*p,l=r[0]+a*y,i=[l,u=r[1]-a*d],a=t*g,l=r[0]-a*y,s=[l,u=r[1]+a*d]):(l=r[0]+t*(e[0]-r[0]),i=[l,u=r[1]+t*(e[1]-r[1])],l=r[0]+t*(o[0]-r[0]),s=[l,u=r[1]+t*(o[1]-r[1])]),[i,s]},C=t=>{let e=1;switch(t){case t<=1:e=1;break;case 2===t:e=2;break;case 3===t:e=6;break;case 24===t:e=24;break;case 5===t:e=120;break;default:for(let r=1;r<=t;r++)e*=r}return e},S=(t,e)=>C(t)/(C(e)*C(t-e)),b=function(t){if(t.length<=2)return t;{let e=[],r=t.length-1;for(let o=0;o<=1;o+=.01){let[n,i]=[0,0];for(let e=0;e<=r;e++){let s=S(r,e),a=Math.pow(o,e),l=Math.pow(1-o,r-e);n+=s*a*l*t[e][0],i+=s*a*l*t[e][1]}e.push([n,i])}return e.push(t[r]),e}},M=t=>{let e=typeof t;return null!==t&&("object"===e||"function"===e)},v=(t,e,n,i,a,l,h,u)=>{let c;if(!e)return null;if(e.length<=2||!i)return a&&!function(t,e,o,n,i){if(!!r.Util.isArrayHasData(e))s._path(t,e,void 0,o),s._stroke(t,o)}(t,e,n),null;let d=e.length,y=l?d:d-1;void 0!==u&&(y-=Math.max(y-h-1,0));for(let r=0;r<y;r++){let n,s,a,h,p,g;let m=e[r].x,P=e[r].y;r-1<0?l?(n=e[y-1].x,s=e[y-1].y):(n=e[r+1].x,s=e[r+1].y):(n=e[r-1].x,s=e[r-1].y),r+1<d?(a=e[r+1].x,h=e[r+1].y):(a=e[r+1-d].x,h=e[r+1-d].y),r+2<d?(p=e[r+2].x,g=e[r+2].y):l?(p=e[r+2-d].x,g=e[r+2-d].y):(p=e[r].x,g=e[r].y);let _=function(t,e,r,o,n,i,s,a,l,h){let u=(t+r)/2,c=(e+o)/2,d=(r+n)/2,y=(o+i)/2,p=(n+s)/2,g=(i+a)/2,m=Math.sqrt((r-t)*(r-t)+(o-e)*(o-e)),P=Math.sqrt((n-r)*(n-r)+(i-o)*(i-o)),_=m/(m+P),f=P/(P+Math.sqrt((s-n)*(s-n)+(a-i)*(a-i))),w=u+(d-u)*_,x=c+(y-c)*_,C=d+(p-d)*f,S=y+(g-y)*f,b=w+(d-w)*l+r-w,M=x+(y-x)*l+o-x,v=C+(d-C)*l+n-C,A=S+(y-S)*l+i-S,O=[b,M,v,A];return h<1?function(t,e,r,o,n,i,s,a,l,h){let u=1,c=1-e,d=r*c*c+2*n*e*c+s*e*e,y=n*c*c+2*s*e*c+l*e*e,p=o*c*c+2*i*e*c+a*e*e,g=i*c*c+2*a*e*c+h*e*e;return[(r*u*u+2*n*t*u+s*t*t)*c+(n*u*u+2*s*t*u+l*t*t)*e,(o*u*u+2*i*t*u+a*t*t)*c+(i*u*u+2*a*t*u+h*t*t)*e,d*u+y*t,p*u+g*t,d*c+y*e,p*c+g*e]}(0,h,r,o,b,M,v,A,n,i):O}(n,s,m,P,a,h,p,g,i,r===y-1?u:1);if(r===y-1&&u>=0&&u<1){t&&t.bezierCurveTo(_[0],_[1],_[2],_[3],_[4],_[5]),e.splice(y-1,d-(y-1)-1);let r=new o(_[4],_[5]);r.prevCtrlPoint=new o(_[2],_[3]),e.push(r),d=e.length}else t&&t.bezierCurveTo(_[0],_[1],_[2],_[3],a,h);e[r].nextCtrlPoint=_.slice(0,2),e[r].prevCtrlPoint=c?c.slice(2):null,c=_}return!l&&e[1].prevCtrlPoint&&(e[0].nextCtrlPoint=e[1].prevCtrlPoint,delete e[0].prevCtrlPoint),!e[d-1].prevCtrlPoint&&(e[d-1].prevCtrlPoint=e[d-2].nextCtrlPoint),a&&s._stroke(t,n),e};class A extends r.Curve{static fromJSON(t){let e=t.feature,r=new A(e.geometry.coordinates,t.options);return r.setProperties(e.properties),r}_toJSON(t){return{feature:this.toGeoJSON(t),subType:"StraightArrow"}}startEdit(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.newVertexHandleSymbol={markerType:"ellipse",markerFill:"#fff",markerLineColor:"#000",markerLineWidth:2,markerWidth:10,markerHeight:10,opacity:0},super.startEdit(t)}_getPaintParams(){let t=this.getMap().getGLScale(),e=this._getPath2DPoints(this._getPrjCoordinates());if(e.length<=1)return null;let r=this._get2DLength()*this.options.widthRatio,o=l(e,r,this.getMap()),n=o[0][o[0].length-1],i=o[1][o[1].length-1],s=this._getArrowHead(n,i,e,r,1,.8,1.4,2.2,.7,2.3),a=[];a.push.apply(a,o[0]),a.push.apply(a,s);for(let t=o[1].length-1;t>=0;t--)a.push(o[1][t]);return[a=a.map(e=>e.multi(t)),[o[0].length,s.length,o[1].length]]}_paintOn(t,e,o,n,i,s){let a;t.beginPath();let l=0;t.moveTo(e[0].x,e[0].y),v(t,a=e.slice(0,o[0]),n,.7,!0),l+=o[0],r.Canvas._path(t,e.slice(l,l+o[1]),s,n),l+=o[1],v(t,a=e.slice(l,l+o[2]),n,.7,!0),this._closeArrow(t,e[e.length-1],e[0]),r.Canvas._stroke(t,n),r.Canvas.fillCanvas(t,i,e[0].x,e[0].y)}_closeArrow(t){t.closePath()}_getArrowHead(t,e,o,n,i,s,a,l,h,u){let c;let d=this._getArrowHeadPoint(t,e,o[o.length-1],n*i,s,l),y=new r.Point((d[0].x+d[1].x)/2,(d[0].y+d[1].y)/2),p=this._getArrowHeadPoint(d[0],d[1],y,n*i,a,h)[0],g=new r.Point((d[2].x+d[1].x)/2,(d[2].y+d[1].y)/2),m=this._getArrowHeadPoint(d[2],d[1],g,n*i,a,h)[0];if(2===o.length)c=[t,p,d[1],m,e];else{let n=v(null,o,null,.8,!1),i=new r.Point(n[n.length-1].prevCtrlPoint),s=o[o.length-1],a=s.sub(i);if(0===a.x&&0===a.y)return[t,p,d[1],m,e];let l=t.distanceTo(e),h=a.unit();c=[t,p,new r.Point(s.x+h.x*l*u,s.y+h.y*l*u),m,e]}return c}_getArrowHeadPoint(t,e,r,n,i,s){!s&&(s=1),t=new o(t.x,t.y),e=new o(e.x,e.y);let a=t.sub(e)._unit(),l=r.add(n*a.x*i,n*a.y*i),h=r.add(-(n*a.x)*i,-(n*a.y)*i);return a._perp()._mult(-1),[l,r.add(s*n*a.x,s*n*a.y),h]}}A.mergeOptions({widthRatio:.1,arrowStyle:[],tailWidthFactor:.1,headWidthFactor:1,neckWidthFactor:.2,headAngle:Math.PI/8.5,neckAngle:Math.PI/13}),A.registerJSONType("StraightArrow"),r.DrawTool.registerMode("StraightArrow",{action:["click","mousemove","dblclick"],create(t,e){let r=new A(e.map(e=>t.unproject(e)));return r._setPrjCoordinates(e),r},update(t,e,r){let o;Array.isArray(e)?o=e:(o=r._getPrjCoordinates()).push(e);let n=o.map(e=>t.unproject(e));r.setCoordinates(n),r._setPrjCoordinates(o)},generate:t=>t});class O extends A{static fromJSON(t){let e=t.feature,r=new O(e.geometry.coordinates,t.options);return r.setProperties(e.properties),r}_toJSON(t){return{feature:this.toGeoJSON(t),subType:"DiagonalArrow"}}_getPaintParams(){let t=this._getPath2DPoints(this._getPrjCoordinates());if(t.length<=1)return null;let e=this.getMap().getGLScale(),r=this._get2DLength(),o=r*this.options.widthRatio,n=l(t,o,this.getMap(),.15,r),i=n[0][n[0].length-1],s=n[1][n[1].length-1],a=this._getArrowHead(i,s,t,o,.3,.6,1.4,2.2,.8,3.3),h=[];h.push.apply(h,n[0]),h.push.apply(h,a);for(let t=n[1].length-1;t>=0;t--)h.push(n[1][t]);return[h=h.map(t=>t.multi(e)),[n[0].length,a.length,n[1].length]]}}O.mergeOptions({widthRatio:.2,arrowStyle:[]}),O.registerJSONType("DiagonalArrow"),r.DrawTool.registerMode("DiagonalArrow",{action:["click","mousemove","dblclick"],create:function(t,e){let r=new O(e.map(e=>t.unproject(e)));return r._setPrjCoordinates(e),r},update:function(t,e,r){let o;Array.isArray(e)?o=e:(o=r._getPrjCoordinates()).push(e);let n=o.map(e=>t.unproject(e));r.setCoordinates(n),r._setPrjCoordinates(o)},generate:function(t){return t}});class j extends O{static fromJSON(t){let e=t.feature,r=new j(e.geometry.coordinates,t.options);return r.setProperties(e.properties),r}_toJSON(t){return{feature:this.toGeoJSON(t),subType:"DoveTailDiagonalArrow"}}_closeArrow(t,e,r){let n=this.getMap().getPitch(),i=new o(e.x,e.y),s=new o(r.x,r.y),a=new o(i.x+s.x,i.y+s.y).mult(.5),l=-i.dist(s),h=i.sub(s)._unit()._perp(),u=.618-.518*n/80,c=a.x+l*u*h.x,d=a.y+l*u*h.y;t.lineTo(c,d),t.closePath()}}j.mergeOptions({widthRatio:.2,arrowStyle:[]}),j.registerJSONType("DoveTailDiagonalArrow"),r.DrawTool.registerMode("DoveTailDiagonalArrow",{action:["click","mousemove","dblclick"],create:function(t,e){let r=new j(e.map(e=>t.unproject(e)));return r._setPrjCoordinates(e),r},update:function(t,e,r){let o;Array.isArray(e)?o=e:(o=r._getPrjCoordinates()).push(e);let n=o.map(e=>t.unproject(e));r.setCoordinates(n),r._setPrjCoordinates(o)},generate:function(t){return t}});class T extends r.Curve{startEdit(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.newVertexHandleSymbol={markerType:"ellipse",markerFill:"#fff",markerLineColor:"#000",markerLineWidth:2,markerWidth:10,markerHeight:10,opacity:0},super.startEdit(t)}_getPaintParams(){let t=this.getMap().getGLScale(),e=this._generate();if(!e||!this._getProjection())return null;this._verifyProjection();let r=this._projectCoords(e),o=this._getPath2DPoints(r);return[o=o.map(e=>e.multi(t)),[]]}_paintOn(t,e,o,n,i){if(!(e.length<=0)){t.strokeStyle=this.getSymbol().lineColor||"#f00",t.beginPath(),t.moveTo(e[0].x,e[0].y);for(let r=1;r<e.length;r++)t.lineTo(e[r].x,e[r].y);t.closePath(),r.Canvas._stroke(t,n),r.Canvas.fillCanvas(t,i,e[0].x,e[0].y)}}}let k=T,N={headHeightFactor:.25,headWidthFactor:.3,neckHeightFactor:.85,neckWidthFactor:.15};class J extends k{_generate(){let t=[],e=this.getCoordinates(),o=e.length,n=r.Coordinate.toNumberArrays(e);if(o<2)return null;if(2===o)return this.setCoordinates(e),null;{let[e,i,s]=[n[0],n[1],n[2]];3===o?(this.symmetricalPoints=J.getSymmetricalPoints(e,i,s),this.connetPoints=p(e,i)):4===o?(this.symmetricalPoints=n[3],this.connetPoints=p(e,i)):o;let[a,l]=[void 0,void 0];P(e,i,s)?(a=J.getArrowPoints(e,this.connetPoints,this.symmetricalPoints,!1),l=J.getArrowPoints(this.connetPoints,i,s,!0)):(a=J.getArrowPoints(i,this.connetPoints,s,!1),l=J.getArrowPoints(this.connetPoints,e,this.symmetricalPoints,!0));let h=a.length,u=(h-5)/2,c=a.slice(0,u),d=a.slice(u,u+5),y=a.slice(u+5,h),g=l.slice(0,u),m=l.slice(u,u+5),_=l.slice(u+5,h);g=b(g);let f=b(_.concat(c.slice(1)));y=b(y),t=(t=g.concat(m,f,d,y)).map(t=>new r.Coordinate(t))}return t}getPlotType(){return this.type}_exportGeoJSONGeometry(){return{type:"Polygon",coordinates:r.Coordinate.toNumberArrays([this.getShell()])}}_toJSON(t){let e=r.Util.extend({},t),o=this.getCoordinates();e.geometry=!1;let n=this.toGeoJSON(e);return n.geometry={type:"Polygon"},{feature:n,subType:"DoubleArrow",coordinates:o}}static getArrowPoints(t,e,r,o){let i=p(t,e),s=h(i,r),a=f(r,i,0,.3*s,!0),l=f(r,i,0,.5*s,!0);a=f(i,a,n,s/5,o),l=f(i,l,n,s/4,o);let u=[i,a,l,r],c=J._getArrowHeadPoints(u);if(c&&Array.isArray(c)&&c.length>0){let[r,o]=[c[0],c[4]],n=h(t,e)/y(u)/2,i=J._getArrowBodyPoints(u,r,o,n);if(i){let n=i.length,s=i.slice(0,n/2),a=i.slice(n/2,n);return s.push(r),a.push(o),(s=s.reverse()).push(e),(a=a.reverse()).push(t),s.reverse().concat(c,a)}}return null}static _getArrowHeadPoints(t){let e=y(t)*N.headHeightFactor,r=t[t.length-1],o=e*N.headWidthFactor,i=e*N.neckWidthFactor,s=e*N.neckHeightFactor,a=f(t[t.length-2],r,0,e,!0),l=f(t[t.length-2],r,0,s,!0),h=f(r,a,n,o,!1),u=f(r,a,n,o,!0),c=f(r,l,n,i,!1),d=f(r,l,n,i,!0);return[c,h,r,u,d]}static _getArrowBodyPoints(t,e,r,o){let n=d(t),i=y(t)*o,s=(i-h(e,r))/2,a=0,l=[],u=[];for(let e=1;e<t.length-1;e++){let r=m(t[e-1],t[e],t[e+1])/2,o=(i/2-(a+=h(t[e-1],t[e]))/n*s)/Math.sin(r),c=f(t[e-1],t[e],Math.PI-r,o,!0),d=f(t[e-1],t[e],r,o,!1);l.push(c),u.push(d)}return l.concat(u)}static getSymmetricalPoints(t,e,r){let o=p(t,e),i=h(o,r),s=m(t,o,r),[a,l,u,c]=[void 0,void 0,void 0,void 0];return s<n?(l=i*Math.sin(s),u=i*Math.cos(s),c=f(t,o,n,l,!1),a=f(o,c,n,u,!0)):s>=n&&s<Math.PI?(l=i*Math.sin(Math.PI-s),u=i*Math.cos(Math.PI-s),c=f(t,o,n,l,!1),a=f(o,c,n,u,!1)):s>=Math.PI&&s<1.5*Math.PI?(l=i*Math.sin(s-Math.PI),u=i*Math.cos(s-Math.PI),c=f(t,o,n,l,!0),a=f(o,c,n,u,!0)):(l=i*Math.sin(2*Math.PI-s),u=i*Math.cos(2*Math.PI-s),c=f(t,o,n,l,!0),a=f(o,c,n,u,!1)),a}static fromJSON(t){let e=t.feature,r=new J(t.coordinates,t.options);return r.setProperties(e.properties),r}constructor(t,e={}){super(t,e),this.type="DoubleArrow",this.connetPoints=[],this.symmetricalPoints=[]}}J.registerJSONType("DoubleArrow"),r.DrawTool.registerMode("DoubleArrow",{action:["click","mousemove","dblclick"],create(t,e){let o=e.map(e=>t.unproject(e)),n=new r.LineString(o);return n._setPrjCoordinates(e),n},update(t,e,r,o){let n;let i=r.getSymbol();Array.isArray(e)?n=e:(n=r._getPrjCoordinates()).push(e);let s=n.map(e=>t.unproject(e));r.setCoordinates(s),r._setPrjCoordinates(n);let a=r.getLayer();if(a){let t=a.getMap(),n=a.getGeometryById("doublearrow");!n&&e.length>=3&&((n=new J(e,{id:"doublearrow"}))._drawTool=o.drawTool||t._map_tool,n.addTo(a),i&&n.setSymbol(i),r.updateSymbol({lineOpacity:0})),n&&(n.setCoordinates(s),n._setPrjCoordinates(e),r.updateSymbol({lineOpacity:0}))}},generate(t){let e=t.getSymbol();e.lineOpacity=1;let r=t.getCoordinates();return r.length>4&&(r=r.slice(0,4)),new J(r,{symbol:e})}});let D=J;class G extends k{getPlotType(){return this.type}_generate(){let t=this.getCoordinates(),e=t.length;if(e<2)return null;if(2===e)return this.setCoordinates(t),null;{let e=r.Coordinate.toNumberArrays(t);e.push(e[0],e[1]);let[o,n]=[[],[]];for(let t=0;t<e.length-2;t++){let r=x(this._offset,e[t],e[t+1],e[t+2]);o=o.concat(r)}let i=o.length;o=[o[i-1]].concat(o.slice(0,i-1));for(let t=0;t<e.length-2;t++){let r=e[t],i=e[t+1];n.push(r);for(let e=0;e<=100;e++){let s=_(e/100,r,o[2*t],o[2*t+1],i);n.push(s)}n.push(i)}return n=n.map(t=>new r.Coordinate(t))}}_exportGeoJSONGeometry(){return{type:"Polygon",coordinates:r.Coordinate.toNumberArrays([this.getShell()])}}_toJSON(t){let e=r.Util.extend({},t),o=this.getCoordinates();e.geometry=!1;let n=this.toGeoJSON(e);return n.geometry={type:"Polygon"},{feature:n,subType:"ClosedCurve",coordinates:o}}static fromJSON(t){let e=t.feature,r=new G(t.coordinates,t.options);return r.setProperties(e.properties),r}constructor(t,e={}){super(t,e),this.type="ClosedCurve",this._offset=.3,t&&this.setCoordinates(t)}}G.registerJSONType("ClosedCurve"),r.DrawTool.registerMode("ClosedCurve",{action:["click","mousemove","dblclick"],create(t,e){let o=e.map(e=>t.unproject(e)),n=new r.LineString(o);return n._setPrjCoordinates(e),n},update(t,e,r){let o;let n=r.getSymbol();Array.isArray(e)?o=e:(o=r._getPrjCoordinates()).push(e);let i=o.map(e=>t.unproject(e));r.setCoordinates(i),r._setPrjCoordinates(o);let s=r.getLayer();if(s){let t=s.getGeometryById("closedcurve");!t&&e.length>=3&&((t=new G([e],{id:"closedcurve"})).addTo(s),n&&t.setSymbol(n),r.updateSymbol({lineOpacity:0})),t&&(t.setCoordinates(i),t._setPrjCoordinates(e),r.updateSymbol({lineOpacity:0}))}},generate(t){let e=t.getSymbol();return e.lineOpacity=1,new G(t.getCoordinates(),{symbol:e})}});let I=G;class H extends k{getPlotType(){return this.type}_generate(){let t=[],e=this.getCoordinates(),o=e.length,n=r.Coordinate.toNumberArrays(e);if(o<=2)return this.setCoordinates(n),null;if(3===o){let[e,o,i]=[n[0],n[1],n[2]],s=this._getMeasurer(),a=u(s,o,e),l=g(o,e),h=g(i,e),d=c(s,e,a,l,h);d.push(e,d[0]),t=d.map(t=>new r.Coordinate(t))}else;return t}_exportGeoJSONGeometry(){return{type:"Polygon",coordinates:r.Coordinate.toNumberArrays([this.getShell()])}}_toJSON(t){let e=r.Util.extend({},t),o=this.getCoordinates();e.geometry=!1;let n=this.toGeoJSON(e);return n.geometry={type:"Polygon"},{feature:n,subType:"PlotSector",coordinates:o}}static fromJSON(t){let e=t.feature,r=new H(t.coordinates,t.options);return r.setProperties(e.properties),r}constructor(t,e={}){super(t,e),this.type="PlotSector",t&&this.setCoordinates(t)}}H.registerJSONType("PlotSector"),r.DrawTool.registerMode("PlotSector",{action:["click","mousemove","dblclick"],create(t,e){let o=e.map(e=>t.unproject(e)),n=new r.LineString(o);return n._setPrjCoordinates(e),n},update(t,e,o,n){let i;let s=o.getSymbol();Array.isArray(e)?i=e:(i=o._getPrjCoordinates()).push(e);let a=i.map(e=>t.unproject(e));o.setCoordinates(a),o._setPrjCoordinates(i);let l=o.getLayer();if(l){let t=l.getMap(),h=l.getGeometryById("sector");if(!h&&e.length>=3){(h=new H(e,{id:"sector"}))._drawTool=n.drawTool||t._map_tool,h.addTo(l);let i=r.Util.extendSymbol(s,{});i&&h.setSymbol(i),o.updateSymbol({lineOpacity:0})}h&&(h.setCoordinates(a),h._setPrjCoordinates(i),o.updateSymbol({lineOpacity:0}))}},generate(t){let e=t.getSymbol();e.lineOpacity=1;let r=t.getCoordinates();return r.length>3&&(r=r.slice(0,3)),new H(r,{symbol:e})}});let L=H;class W extends k{getPlotType(){return this.type}_generate(){let t=this.getCoordinates(),e=t.length,o=r.Coordinate.toNumberArrays(t);if(e<2)return;if(2===e){let t=p(o[0],o[1]),e=h(o[0],t)/.9,r=f(o[0],t,n,e,!0);o=[o[0],r,o[1]]}let i=p(o[0],o[2]);o.push(i,o[0],o[1]);let[s,a,l,u,c]=[[],void 0,void 0,void 0,[]];for(let t=0;t<o.length-2;t++){a=o[t],l=o[t+1],u=o[t+2];let e=x(this._offset,a,l,u);s=s.concat(e)}e=s.length,s=[s[e-1]].concat(s.slice(0,e-1));for(let t=0;t<o.length-2;t++){a=o[t],l=o[t+1],c.push(a);for(let e=0;e<=100;e++){let r=_(e/100,a,s[2*t],s[2*t+1],l);c.push(r)}c.push(l)}return c=c.map(t=>new r.Coordinate(t))}_exportGeoJSONGeometry(){return{type:"Polygon",coordinates:r.Coordinate.toNumberArrays([this.getShell()])}}_toJSON(t){let e=r.Util.extend({},t),o=this.getCoordinates();e.geometry=!1;let n=this.toGeoJSON(e);return n.geometry={type:"Polygon"},{feature:n,subType:"GatheringPlace",coordinates:o}}static fromJSON(t){let e=t.feature,r=new W(t.coordinates,t.options);return r.setProperties(e.properties),r}constructor(t,e={}){super(t,e),this.type="GatheringPlace",this._offset=.4,t&&this.setCoordinates(t)}}W.registerJSONType("GatheringPlace"),r.DrawTool.registerMode("GatheringPlace",{action:["click","mousemove","dblclick"],create(t,e){let r=new W(e.map(e=>t.unproject(e)));return r._setPrjCoordinates(e),r},update(t,e,r){let o;let n=r.getSymbol();Array.isArray(e)?o=e:(o=r._getPrjCoordinates()).push(e);let i=o.map(e=>t.unproject(e));r.setCoordinates(i),r._setPrjCoordinates(o);let s=r.getLayer();if(s){let t=s.getGeometryById("gatheringplace");!t&&e.length>=3&&((t=new W([e],{id:"gatheringplace"})).addTo(s),n&&t.setSymbol(n),r.updateSymbol({lineOpacity:0})),t&&(t.setCoordinates(i),t._setPrjCoordinates(e),r.updateSymbol({lineOpacity:0}))}},generate(t){let e=t.getSymbol();return e.lineOpacity=1,new W(t.getCoordinates(),{symbol:e})}});let F=W})();var r=maptalks="undefined"==typeof maptalks?{}:maptalks;for(var o in e)r[o]=e[o];e.__esModule&&Object.defineProperty(r,"__esModule",{value:!0})})();